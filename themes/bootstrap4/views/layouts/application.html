{{define "application/header"}}
<!DOCTYPE html>
<html lang="{{.locale}}">
  <head>
    {{template "metas" .}}
    <title>{{.title}}-{{t .locale "site.sub_title"}}-{{t .locale "site.title"}}</title>
  </head>
  <body>
    {{template "application/nav-bar" .}}
    <div class="container">
      {{template "flashs" .}}
{{end}}

{{define "application/nav-bar"}}
{{$l := .locale}}
<nav class="navbar navbar-fixed-top navbar-dark bg-inverse">
  <a href="/" class="navbar-brand">{{t $l "site.sub_title"}}</a>
  <ul class="nav navbar-nav">
    <li class="nav-item active">
      <a class="nav-link" href="/">{{t $l "header.home"}} <span class="sr-only">(current)</span></a>
    </li>
    {{range links "top"}}
      <li class="nav-item">
        <a class="nav-link" href="{{$.Href}}">{{t $l $.label}}</a>
      </li>
    {{end}}
    {{template "personal-bar" .}}
    {{template "language-bar" .}}
  </ul>
</nav>
{{end}}

{{define "application/footer"}}
{{$l := .locale}}
<hr/>
<footer>
  <p class="float-xs-right">
    {{t $l "footer.other-languages"}}
    {{range .languages}}
      {{$m := fmt "languages.%s" .}}
      <a href="/?locale={{.}}">{{t $l $m}}</a>
    {{end}}
  </p>
  <p>
    &copy; {{t $l "site.copyright"}}
    {{range links "bottom"}}
      &middot; <a href="{{$.Href}}">{{t $l $.Label}}</a>
    {{end}}
  </p>
</footer>
</div>
</body>
</html>
{{end}}

{{define "personal-bar"}}
{{$l := .locale}}
{{if .current_user}}
<li class="nav-item dropdown float-xs-right">
  <a class="nav-link dropdown-toggle" id="personal-bar" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    {{t $l "language-bar.welcome" .current_user.full_name}}
  </a>
  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="personal-bar">
  </div>
</li>
{{else}}
<li class="nav-item dropdown float-xs-right">
  <a class="nav-link dropdown-toggle" id="personal-bar" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    {{t $l "personal-bar.sign-in-or-up"}}
  </a>
  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="personal-bar">
    <a class="dropdown-item" href="/personal/sign-in">{{t $l "auth.personal.sign-in.title"}}</a>
    <a class="dropdown-item" href="/personal/sign-up">{{t $l "auth.personal.sign-up.title"}}</a>
    <a class="dropdown-item" href="/personal/forgot-password">{{t $l "auth.personal.forgot-password.title"}}</a>
    <a class="dropdown-item" href="/personal/confirm">{{t $l "auth.personal.confirm.title"}}</a>
    <a class="dropdown-item" href="/personal/unlock">{{t $l "auth.personal.unlock.title"}}</a>
  </div>
</li>
{{end}}
{{end}}

{{define "language-bar"}}
{{$l := .locale}}
<li class="nav-item dropdown float-xs-right">
  <a class="nav-link dropdown-toggle" id="language-bar" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    {{t $l "language-bar.switch"}}
  </a>
  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="language-bar">
    {{range .languages}}
      {{$m := fmt "languages.%s" .}}
      <a class="dropdown-item" href="/?locale={{.}}">{{t $l $m}}</a>
    {{end}}
  </div>
</li>
{{end}}
